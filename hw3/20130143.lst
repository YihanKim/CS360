
/* 2016 Fall CS360 Assignment 3 */
/* 20130143 Yihan Kim */

/* 1-1
/* FIND THE MAKERS OF PC'S WITH A SPEED OF AT LEAST 3.0 */
SELECT DISTINCT MAKER
FROM PRODUCT
WHERE MODEL IN
	(SELECT MODEL
	FROM PC
	WHERE SPEED > 3.0);

SELECT DISTINCT MAKER
FROM
	(SELECT *
	FROM PRODUCT
	INNER JOIN PC
	ON PRODUCT.MODEL = PC.MODEL
	WHERE SPEED > 3.0);

/* 1-2
/* FIND THE MODEL OF THE ITEM (PC, LAPTOP, PRINTER) WITH THE HIGHEST PRICE */
SELECT MODEL FROM
	(SELECT MODEL, PRICE FROM PC UNION
	SELECT MODEL, PRICE FROM LAPTOP UNION
	SELECT MODEL, PRICE FROM PRINTER)
WHERE  PRICE >= ALL (
		(SELECT PRICE FROM PC UNION
		SELECT PRICE FROM LAPTOP UNION
		SELECT PRICE FROM PRINTER));

SELECT MODEL
FROM
	(SELECT MODEL, PRICE FROM PC UNION
	SELECT MODEL, PRICE FROM LAPTOP UNION
	SELECT MODEL, PRICE FROM PRINTER)
Where PRICE =
  (SELECT MAX(PRICE) FROM
  	(SELECT MODEL, PRICE FROM PC UNION
  	SELECT MODEL, PRICE FROM LAPTOP UNION
  	SELECT MODEL, PRICE FROM PRINTER)) ;

/* 1-3
/* FIND THE MAKER OF THE COLOR PRINTER WITH THE LOWEST PRICE */

SELECT MAKER FROM PRODUCT WHERE MODEL =
	(SELECT MODEL FROM PRINTER WHERE COLOR = 1 AND PRICE =
		(SELECT MIN(PRICE) FROM PRINTER WHERE COLOR = 1));

SELECT MAKER
FROM PRODUCT INNER JOIN PRINTER
ON PRODUCT.MODEL = PRINTER.MODEL
WHERE COLOR = 1 AND PRICE =
	(SELECT MIN(PRICE) FROM PRINTER WHERE COLOR = 1);

/* 2-1
/* WHAT PC MODELS HAVE A SPEED OF AT LEAST 3.00? */
SELECT DISTINCT MODEL FROM PC WHERE SPEED >= 3.0;

/* 2-2
/* FIND THOSE MANUFACTURERS THAT SELL LAPTOPS, BUT NOT PC'S */

(SELECT DISTINCT MAKER FROM PRODUCT WHERE TYPE='laptop')
MINUS
(SELECT DISTINCT MAKER FROM PRODUCT WHERE TYPE='pc');

/* 2-3
/* FIND THOSE PAIRS OF PC MODELS THAT HAVE BOTH THE SAME SPEED AND RAM.
     A PAIR SHOULD BE LISTED ONLY ONCE; E.G., LIST(I, J) BUT NOT (J, I). */
SELECT PC1.MODEL , PC2.MODEL
FROM PC PC1, PC PC2
WHERE PC1.RAM = PC2.RAM
	AND PC1.SPEED = PC2.SPEED
	AND PC1.MODEL < PC2.MODEL;

/* 2-4
/* FIND THE MANUFACTURER(S) OF THE COMPUTER (PC OR LAPTOP) WITH THE HIGHEST AVAILABLE SPEED. */
SELECT DISTINCT MAKER FROM PRODUCT
WHERE MODEL IN (
	(SELECT MODEL FROM
	((SELECT SPEED, MODEL FROM PC)
	UNION
	(SELECT SPEED, MODEL FROM LAPTOP))
	Where speed >=  (
		SELECT MAX(SPEED) FROM
		((SELECT SPEED, MODEL FROM PC)
		UNION
		(SELECT SPEED, MODEL FROM LAPTOP)))));

/* 3-1.
/* FIND FOR EACH MANUFACTURER, THE AVERAGE SCREEN SIZE OF ITS LAPTOPS */
SELECT MAKER, AVG(SCREEN)
FROM LAPTOP INNER JOIN PRODUCT
ON PRODUCT.MODEL = LAPTOP.MODEL
GROUP BY MAKER;

/* 3-2.
/* FIND THE MANUFACTURERS THAT MAKE AT LEAST THREE DIFFERENT MODELS OF PC. */
SELECT MAKER
FROM PC INNER JOIN PRODUCT
ON PRODUCT.MODEL = PC.MODEL
GROUP BY MAKER
HAVING COUNT(PC.MODEL) >= 3;

/* 3-3.
/* FIND THE AVERAGE HARD DISK SIZE OF A PC FOR ALL THOSE MANUFACTURER'S THAT MAKE PRINTERS. */
SELECT AVG(HD)
FROM PC
WHERE MODEL IN
	(SELECT MODEL FROM PRODUCT WHERE MAKER IN
		(SELECT MAKER FROM PRODUCT WHERE TYPE='printer'));
